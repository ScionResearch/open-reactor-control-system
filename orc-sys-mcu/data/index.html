<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Open Reactor Control System</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>Open Reactor Control System</h1>
            <img src="BSI-logo-187x65.png" alt="BSI Logo" style="height:65px;" />
        </header>
        <nav class="tabs">
            <button class="tab-link active" onclick="openTab(event, 'dashboard')">Dashboard</button>
            <button class="tab-link" onclick="openTab(event, 'inputs')">Inputs</button>
            <button class="tab-link" onclick="openTab(event, 'outputs')">Outputs</button>
            <button class="tab-link" onclick="openTab(event, 'devices')">Devices</button>
            <button class="tab-link" onclick="openTab(event, 'comports')">Com Ports</button>
            <button class="tab-link" onclick="openTab(event, 'sensors')">Sensors</button>
            <button class="tab-link" onclick="openTab(event, 'controllers')">Controllers</button>
            <button class="tab-link" onclick="openTab(event, 'control')">Control</button>
            <button class="tab-link" onclick="openTab(event, 'filemanager')">File Manager</button>
            <button class="tab-link" onclick="openTab(event, 'system')">System</button>
            <button class="tab-link" onclick="openTab(event, 'settings')">Settings</button>
        </nav>

        <main id="main-content">
            <!-- Dashboard Tab -->
            <div id="dashboard" class="tab-content active">
                <h2>Live Status & Controls</h2>
                <!-- Add dashboard content here -->
            </div>

            <!-- Inputs Tab -->
            <div id="inputs" class="tab-content">
                <h2>Hardware Inputs</h2>
                <p class="page-description">Onboard input channel configuration and monitoring</p>
                
                <div class="inputs-grid">
                    <!-- Analog Inputs Section -->
                    <div class="input-section-card">
                        <h3>Analog Inputs (ADC)</h3>
                        <div id="adc-list" class="input-list">
                            <div class="loading">Loading...</div>
                        </div>
                    </div>
                    
                    <!-- Digital Inputs Section -->
                    <div class="input-section-card">
                        <h3>Digital Inputs</h3>
                        <div id="gpio-list" class="input-list">
                            <div class="loading">Loading...</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Outputs Tab -->
            <div id="outputs" class="tab-content">
                <h2>Hardware Outputs</h2>
                <p class="page-description">Onboard output channel configuration and control</p>
                
                <div class="outputs-grid">
                    <!-- DAC Analog Outputs Section -->
                    <div class="output-section-card">
                        <h3>Analog Outputs (DAC)</h3>
                        <div id="dac-outputs-list" class="output-list">
                            <div class="loading">Loading...</div>
                        </div>
                    </div>
                    
                    <!-- Digital Outputs Section -->
                    <div class="output-section-card">
                        <h3>Digital Outputs</h3>
                        <div id="digital-outputs-list" class="output-list">
                            <div class="loading">Loading...</div>
                        </div>
                    </div>
                    
                    <!-- Stepper Motor Section -->
                    <div class="output-section-card">
                        <h3>Stepper Motor</h3>
                        <div id="stepper-motor-list" class="output-list">
                            <div class="loading">Loading...</div>
                        </div>
                    </div>
                    
                    <!-- DC Motors Section -->
                    <div class="output-section-card">
                        <h3>DC Motors</h3>
                        <div id="dc-motors-list" class="output-list">
                            <div class="loading">Loading...</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Devices Tab (placeholder) -->
            <div id="devices" class="tab-content">
                <h2>Peripheral Devices</h2>
                <p class="page-description">Coming soon...</p>
            </div>

            <!-- Com Ports Tab (placeholder) -->
            <div id="comports" class="tab-content">
                <h2>Serial Communication Ports</h2>
                <p class="page-description">Coming soon...</p>
            </div>

            <!-- Sensors Tab -->
            <div id="sensors" class="tab-content">
                <h2>Sensor Objects</h2>
                <p class="page-description">Configured sensor objects based on physical inputs</p>
                
                <div class="inputs-grid">
                    <!-- RTD Temperature Sensors Section -->
                    <div class="input-section-card">
                        <h3>RTD Temperature Sensors</h3>
                        <div id="rtd-list" class="input-list">
                            <div class="loading">Loading...</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Controllers Tab (placeholder) -->
            <div id="controllers" class="tab-content">
                <h2>Control Loops</h2>
                <p class="page-description">Coming soon...</p>
            </div>

            <!-- File Manager Tab -->
            <div id="filemanager" class="tab-content">
                <h2>SD Card File Manager</h2>
                <p class="page-description">Browse and download files from the device's SD card.</p>
                
                <div class="file-manager">
                    <div id="sd-status" class="status-message"></div>
                    
                    <div id="path-navigator" class="path-navigator"></div>
                    
                    <div class="file-list">
                        <div class="file-list-header">
                            <div>Name</div>
                            <div>Size</div>
                            <div>Modified</div>
                            <div>Actions</div>
                        </div>
                        <div id="file-list-items" class="file-list-items">
                            <div class="loading">Loading files...</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- System Tab -->
            <div id="system" class="tab-content">
                <h2>System Status</h2>
                <div class="system-header">
                    <p class="page-description">Current status of system components and resources</p>
                    <button id="rebootButton" class="reboot-button">Reboot System</button>
                </div>
                <div class="status-section-grid">
                    <div class="status-card">
                        <h3>Power Supplies</h3>
                        <div class="status-values">
                            <div class="status-item">
                                <span class="label">Main Supply:</span>
                                <span class="value" id="mainVoltage">--V</span>
                                <span class="status" id="mainVoltageStatus">--</span>
                            </div>
                            <div class="status-item">
                                <span class="label">20V Supply:</span>
                                <span class="value" id="v20Voltage">--V</span>
                                <span class="status" id="v20VoltageStatus">--</span>
                            </div>
                            <div class="status-item">
                                <span class="label">5V Supply:</span>
                                <span class="value" id="v5Voltage">--V</span>
                                <span class="status" id="v5VoltageStatus">--</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="status-card">
                        <h3>Real Time Clock</h3>
                        <div class="status-values">
                            <div class="status-item">
                                <span class="label">Status:</span>
                                <span class="status" id="rtcStatus">--</span>
                            </div>
                            <div class="status-item">
                                <span class="label">Time:</span>
                                <span class="value" id="rtcTime">--</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="status-card">
                        <h3>Communications</h3>
                        <div class="status-values">
                            <div class="status-item">
                                <span class="label">IPC Status:</span>
                                <span class="status" id="ipcStatus">--</span>
                            </div>
                            <div class="status-item">
                                <span class="label">MQTT Status:</span>
                                <span class="status" id="mqttStatus">--</span>
                            </div>
                            <div class="status-item">
                                <span class="label">Modbus Status:</span>
                                <span class="status" id="modbusStatus">--</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="status-card">
                        <h3>SD Card</h3>
                        <div class="status-values">
                            <div class="status-item">
                                <span class="label">Status:</span>
                                <span class="status" id="sdStatus">--</span>
                            </div>
                            <div class="status-item" id="sdCapacityContainer">
                                <span class="label">Capacity:</span>
                                <span class="value" id="sdCapacity">-- GB</span>
                            </div>
                            <div class="status-item" id="sdFreeSpaceContainer">
                                <span class="label">Free Space:</span>
                                <span class="value" id="sdFreeSpace">-- GB</span>
                            </div>
                            <div class="status-item" id="sdLogSizeContainer">
                                <span class="label">Log File Size:</span>
                                <span class="value" id="sdLogSize">-- kB</span>
                            </div>
                            <div class="status-item" id="sdSensorSizeContainer">
                                <span class="label">Sensor File Size:</span>
                                <span class="value" id="sdSensorSize">-- kB</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Settings Tab -->
            <div id="settings" class="tab-content">
                <h2>System Settings</h2>
                <div class="settings-section">
                    <h3>Date and Time</h3>
                    <div class="live-clock">
                        <span id="liveClock"></span>
                    </div>
                    <div class="form-group">
                        <label for="currentDate">Change Date:</label>
                        <input type="date" id="currentDate" pattern="\d{4}-\d{2}-\d{2}">
                    </div>
                    <div class="form-group">
                        <label for="currentTime">Change Time:</label>
                        <input type="time" id="currentTime" step="1">
                    </div>
                    <div class="form-group">
                        <label for="timezone">Timezone:</label>
                        <select id="timezone">
                            <option value="+12:00" selected>UTC+12:00 (Auckland)</option>
                            <option value="+11:00">UTC+11:00 (Solomon Islands)</option>
                            <option value="+10:00">UTC+10:00 (Sydney)</option>
                            <option value="+09:00">UTC+09:00 (Tokyo)</option>
                            <option value="+08:00">UTC+08:00 (Singapore, Beijing)</option>
                            <option value="+07:00">UTC+07:00 (Bangkok)</option>
                            <option value="+06:00">UTC+06:00 (Dhaka)</option>
                            <option value="+05:00">UTC+05:00 (Karachi)</option>
                            <option value="+04:00">UTC+04:00 (Dubai)</option>
                            <option value="+03:00">UTC+03:00 (Moscow, Istanbul)</option>
                            <option value="+02:00">UTC+02:00 (Cairo, Athens)</option>
                            <option value="+01:00">UTC+01:00 (Paris, Berlin)</option>
                            <option value="+00:00">UTC+00:00 (London, Dublin)</option>
                            <option value="-01:00">UTC-01:00 (Cape Verde)</option>
                            <option value="-02:00">UTC-02:00 (South Georgia)</option>
                            <option value="-03:00">UTC-03:00 (Brazil, Argentina)</option>
                            <option value="-04:00">UTC-04:00 (Atlantic Time)</option>
                            <option value="-05:00">UTC-05:00 (Eastern Time)</option>
                            <option value="-06:00">UTC-06:00 (Central Time)</option>
                            <option value="-07:00">UTC-07:00 (Mountain Time)</option>
                            <option value="-08:00">UTC-08:00 (Pacific Time)</option>
                            <option value="-09:00">UTC-09:00 (Alaska)</option>
                            <option value="-10:00">UTC-10:00 (Hawaii)</option>
                            <option value="-11:00">UTC-11:00 (American Samoa)</option>
                            <option value="-12:00">UTC-12:00 (Baker Island)</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="enableNTP">Enable NTP</label>
                        <input type="checkbox" id="enableNTP">
                    </div>
                    <div id="ntpStatusContainer" class="form-group" style="display: none;">
                        <div class="form-group">
                            <label>NTP Status:</label>
                            <span id="ntpStatus" class="static-value"></span>
                        </div>
                        <div class="form-group">
                            <label>Last Update:</label>
                            <span id="lastNtpUpdate" class="static-value"></span>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="enableDST">Daylight Saving Time</label>
                        <input type="checkbox" id="enableDST">
                    </div>
                    <button id="saveTimeBtn" class="btn btn-primary">Save Date and Time Settings</button>
                </div>
                
                <div class="settings-section">
                    <h3>Network Configuration</h3>
                    <form id="networkForm">
                        <div class="form-group">
                            <label>IP Configuration:</label>
                            <select id="ipConfig">
                                <option value="dhcp">DHCP</option>
                                <option value="static">Static IP</option>
                            </select>
                        </div>
                        <div id="staticSettings" style="display: none;">
                            <div class="form-group">
                                <label>IP Address:</label>
                                <input type="text" id="ipAddress" 
                                       pattern="^((25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$"
                                       placeholder="192.168.1.100"
                                       title="Please enter a valid IPv4 address">
                            </div>
                            <div class="form-group">
                                <label>Subnet Mask:</label>
                                <input type="text" id="subnetMask" 
                                       pattern="^((25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$"
                                       placeholder="255.255.255.0"
                                       title="Please enter a valid subnet mask">
                            </div>
                            <div class="form-group">
                                <label>Gateway:</label>
                                <input type="text" id="gateway" 
                                       pattern="^((25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$"
                                       placeholder="192.168.1.1"
                                       title="Please enter a valid gateway address">
                            </div>
                            <div class="form-group">
                                <label>DNS Server:</label>
                                <input type="text" id="dns" 
                                       pattern="^((25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$"
                                       placeholder="8.8.8.8"
                                       title="Please enter a valid DNS server address">
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="macAddress">MAC Address:</label>
                            <span id="macAddress" class="static-value"></span>
                        </div>
                        <div class="form-group">
                            <label for="currentIP">Current IP Address:</label>
                            <span id="currentIP" class="static-value"></span>
                        </div>
                        <div class="form-group">
                            <label for="hostName">Hostname:</label>
                            <input type="text" id="hostName" value="open-reactor">
                        </div>
                        <div class="form-group">
                            <label for="ntpServer">NTP Server:</label>
                            <input type="text" id="ntpServer" value="pool.ntp.org">
                        </div>
                        <button type="submit" id="saveNetworkSettings" class="btn">Save Network Settings</button>
                        <div id="networkStatus" class="status-message"></div>
                    </form>
                </div>
                
                <div class="settings-section">
                    <h3>MQTT Configuration</h3>
                    <form id="mqttForm">
                        <div class="form-group">
                            <label for="mqttBroker">Broker Address:</label>
                            <input type="text" id="mqttBroker" name="mqttBroker" placeholder="e.g., mqtt.example.com">
                        </div>
                        <div class="form-group">
                            <label for="mqttPort">Port:</label>
                            <input type="number" id="mqttPort" name="mqttPort" placeholder="1883" min="1" max="65535">
                        </div>
                        <div class="form-group">
                            <label for="mqttUsername">Username:</label>
                            <input type="text" id="mqttUsername" name="mqttUsername">
                        </div>
                        <div class="form-group">
                            <label for="mqttPassword">Password:</label>
                            <input type="password" id="mqttPassword" name="mqttPassword">
                        </div>
                        <button type="submit" class="btn">Save MQTT Settings</button>
                    </form>
                </div>
            </div>

        </main>
    </div>
    
    <!-- Toast Container for notifications -->
    <div id="toastContainer" class="toast-container"></div>
    
    <!-- Reboot Confirmation Modal -->
    <div id="rebootModal" class="modal-overlay">
        <div class="confirmation-modal">
            <h3>Confirm System Reboot</h3>
            <p>Are you sure you want to reboot the system? This will temporarily disconnect all connections.</p>
            <div class="modal-buttons">
                <button id="cancelReboot" class="modal-cancel">Cancel</button>
                <button id="confirmReboot" class="modal-confirm">Yes, Reboot</button>
            </div>
        </div>
    </div>
    
    <!-- ADC Configuration Modal -->
    <div id="adcConfigModal" class="modal-overlay">
        <div class="config-modal">
            <h3>Configure Analog Input <span id="adcConfigIndex"></span></h3>
            <div class="config-form">
                <div class="form-group">
                    <label for="adcConfigName">Name:</label>
                    <input type="text" id="adcConfigName" maxlength="31" placeholder="Sensor name">
                </div>
                
                <div class="form-group">
                    <label for="adcConfigUnit">Unit:</label>
                    <select id="adcConfigUnit">
                        <option value="mV">mV (millivolts)</option>
                        <option value="V">V (volts)</option>
                        <option value="mA">mA (milliamps)</option>
                        <option value="uV">uV (microvolts)</option>
                    </select>
                </div>
                
                <div class="form-section">
                    <h4>Calibration</h4>
                    <div class="calibration-tabs">
                        <button class="cal-tab-btn active" data-tab="two-point">Two-Point Calibration</button>
                        <button class="cal-tab-btn" data-tab="direct">Direct Entry</button>
                    </div>
                    
                    <!-- Two-Point Calibration -->
                    <div id="twoPointCal" class="cal-tab-content active">
                        <p class="cal-description">Enter two calibration points: current displayed value vs actual measured value</p>
                        <div class="cal-point">
                            <h5>Point 1 (Low)</h5>
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="calP1Raw">Displayed Value:</label>
                                    <input type="number" id="calP1Raw" step="0.01" placeholder="e.g., 1500 mV">
                                </div>
                                <div class="form-group">
                                    <label for="calP1Real">Measured Value:</label>
                                    <input type="number" id="calP1Real" step="0.01" placeholder="e.g., 1250 mV">
                                </div>
                            </div>
                        </div>
                        <div class="cal-point">
                            <h5>Point 2 (High)</h5>
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="calP2Raw">Displayed Value:</label>
                                    <input type="number" id="calP2Raw" step="0.01" placeholder="e.g., 2500 mV">
                                </div>
                                <div class="form-group">
                                    <label for="calP2Real">Measured Value:</label>
                                    <input type="number" id="calP2Real" step="0.01" placeholder="e.g., 2100 mV">
                                </div>
                            </div>
                        </div>
                        <button class="btn btn-secondary" onclick="calculateTwoPointCal()">Calculate</button>
                    </div>
                    
                    <!-- Direct Entry -->
                    <div id="directCal" class="cal-tab-content">
                        <p class="cal-description">Directly enter scale and offset values</p>
                        <div class="form-group">
                            <label for="calScale">Scale:</label>
                            <input type="number" id="calScale" step="0.0001" placeholder="1.0">
                        </div>
                        <div class="form-group">
                            <label for="calOffset">Offset:</label>
                            <input type="number" id="calOffset" step="0.01" placeholder="0.0">
                        </div>
                    </div>
                    
                    <div class="cal-result">
                        <div class="form-group">
                            <label>Calculated Scale:</label>
                            <span id="resultScale" class="result-value">--</span>
                        </div>
                        <div class="form-group">
                            <label>Calculated Offset:</label>
                            <span id="resultOffset" class="result-value">--</span>
                        </div>
                        <button class="btn btn-secondary" onclick="resetCalibration()" style="margin-top: 10px;">Reset to Default (1.0, 0.0)</button>
                    </div>
                </div>
                
                <div class="form-group checkbox-group">
                    <label>
                        <input type="checkbox" id="adcShowOnDashboard">
                        Show on Dashboard
                    </label>
                </div>
            </div>
            
            <div class="modal-buttons">
                <button class="modal-cancel" onclick="closeADCConfigModal()">Cancel</button>
                <button class="modal-confirm" onclick="saveADCConfig()">Save</button>
            </div>
        </div>
    </div>
    
    <!-- DAC Configuration Modal -->
    <div id="dacConfigModal" class="modal-overlay">
        <div class="config-modal">
            <h3>Configure Analog Output <span id="dacConfigIndex"></span></h3>
            <div class="config-form">
                <div class="form-group">
                    <label for="dacConfigName">Name:</label>
                    <input type="text" id="dacConfigName" maxlength="31" placeholder="Output name">
                </div>
                
                <div class="form-section">
                    <h4>Calibration</h4>
                    <p class="cal-description" style="margin-bottom: 15px;">Units are fixed at mV (0-10240)</p>
                    <div class="calibration-tabs">
                        <button class="cal-tab-btn active" data-tab="two-point-dac">Two-Point Calibration</button>
                        <button class="cal-tab-btn" data-tab="direct-dac">Direct Entry</button>
                    </div>
                    
                    <!-- Two-Point Calibration -->
                    <div id="twoPointCalDAC" class="cal-tab-content active">
                        <p class="cal-description">Enter two calibration points: current displayed value vs actual measured value</p>
                        <div class="cal-point">
                            <h5>Point 1 (Low)</h5>
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="calP1RawDAC">Displayed Value (mV):</label>
                                    <input type="number" id="calP1RawDAC" step="0.01" placeholder="e.g., 1500">
                                </div>
                                <div class="form-group">
                                    <label for="calP1RealDAC">Measured Value (mV):</label>
                                    <input type="number" id="calP1RealDAC" step="0.01" placeholder="e.g., 1250">
                                </div>
                            </div>
                        </div>
                        <div class="cal-point">
                            <h5>Point 2 (High)</h5>
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="calP2RawDAC">Displayed Value (mV):</label>
                                    <input type="number" id="calP2RawDAC" step="0.01" placeholder="e.g., 2500">
                                </div>
                                <div class="form-group">
                                    <label for="calP2RealDAC">Measured Value (mV):</label>
                                    <input type="number" id="calP2RealDAC" step="0.01" placeholder="e.g., 2100">
                                </div>
                            </div>
                        </div>
                        <button class="btn btn-secondary" onclick="calculateTwoPointCalDAC()">Calculate</button>
                    </div>
                    
                    <!-- Direct Entry -->
                    <div id="directCalDAC" class="cal-tab-content">
                        <p class="cal-description">Directly enter scale and offset values</p>
                        <div class="form-group">
                            <label for="calScaleDAC">Scale:</label>
                            <input type="number" id="calScaleDAC" step="0.0001" placeholder="1.0">
                        </div>
                        <div class="form-group">
                            <label for="calOffsetDAC">Offset:</label>
                            <input type="number" id="calOffsetDAC" step="0.01" placeholder="0.0">
                        </div>
                    </div>
                    
                    <div class="cal-result">
                        <div class="form-group">
                            <label>Calculated Scale:</label>
                            <span id="resultScaleDAC" class="result-value">--</span>
                        </div>
                        <div class="form-group">
                            <label>Calculated Offset:</label>
                            <span id="resultOffsetDAC" class="result-value">--</span>
                        </div>
                        <button class="btn btn-secondary" onclick="resetCalibrationDAC()" style="margin-top: 10px;">Reset to Default (1.0, 0.0)</button>
                    </div>
                </div>
                
                <div class="form-group checkbox-group">
                    <label>
                        <input type="checkbox" id="dacShowOnDashboard">
                        Show on Dashboard
                    </label>
                </div>
            </div>
            
            <div class="modal-buttons">
                <button class="modal-cancel" onclick="closeDACConfigModal()">Cancel</button>
                <button class="modal-confirm" onclick="saveDACConfig()">Save</button>
            </div>
        </div>
    </div>
    
    <!-- RTD Configuration Modal -->
    <div id="rtdConfigModal" class="modal-overlay">
        <div class="config-modal">
            <h3>Configure RTD Sensor <span id="rtdConfigIndex"></span></h3>
            <div class="config-form">
                <div class="form-group">
                    <label for="rtdConfigName">Name:</label>
                    <input type="text" id="rtdConfigName" maxlength="31" placeholder="Sensor name">
                </div>
                
                <div class="form-group">
                    <label for="rtdConfigUnit">Unit:</label>
                    <select id="rtdConfigUnit">
                        <option value="C">°C (Celsius)</option>
                        <option value="F">°F (Fahrenheit)</option>
                        <option value="K">K (Kelvin)</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="rtdConfigWires">Wire Configuration:</label>
                    <select id="rtdConfigWires">
                        <option value="2">2-Wire</option>
                        <option value="3">3-Wire</option>
                        <option value="4">4-Wire</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="rtdConfigType">RTD Type:</label>
                    <select id="rtdConfigType">
                        <option value="100">PT100 (100Ω @ 0°C)</option>
                        <option value="1000">PT1000 (1000Ω @ 0°C)</option>
                    </select>
                </div>
                
                <div class="form-section">
                    <h4>Calibration</h4>
                    <div class="calibration-tabs">
                        <button class="cal-tab-btn active" data-tab="two-point-rtd">Two-Point Calibration</button>
                        <button class="cal-tab-btn" data-tab="direct-rtd">Direct Entry</button>
                    </div>
                    
                    <!-- Two-Point Calibration -->
                    <div id="twoPointCalRTD" class="cal-tab-content active">
                        <p class="cal-description">Enter two calibration points: current displayed value vs actual measured value</p>
                        <div class="cal-point">
                            <h5>Point 1 (Low)</h5>
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="calP1RawRTD">Displayed Value:</label>
                                    <input type="number" id="calP1RawRTD" step="0.01" placeholder="e.g., 20.0 °C">
                                </div>
                                <div class="form-group">
                                    <label for="calP1RealRTD">Measured Value:</label>
                                    <input type="number" id="calP1RealRTD" step="0.01" placeholder="e.g., 19.5 °C">
                                </div>
                            </div>
                        </div>
                        <div class="cal-point">
                            <h5>Point 2 (High)</h5>
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="calP2RawRTD">Displayed Value:</label>
                                    <input type="number" id="calP2RawRTD" step="0.01" placeholder="e.g., 80.0 °C">
                                </div>
                                <div class="form-group">
                                    <label for="calP2RealRTD">Measured Value:</label>
                                    <input type="number" id="calP2RealRTD" step="0.01" placeholder="e.g., 79.2 °C">
                                </div>
                            </div>
                        </div>
                        <button class="btn btn-secondary" onclick="calculateTwoPointCalRTD()">Calculate</button>
                    </div>
                    
                    <!-- Direct Entry -->
                    <div id="directCalRTD" class="cal-tab-content">
                        <p class="cal-description">Directly enter scale and offset values</p>
                        <div class="form-group">
                            <label for="calScaleRTD">Scale:</label>
                            <input type="number" id="calScaleRTD" step="0.0001" placeholder="1.0">
                        </div>
                        <div class="form-group">
                            <label for="calOffsetRTD">Offset:</label>
                            <input type="number" id="calOffsetRTD" step="0.01" placeholder="0.0">
                        </div>
                    </div>
                    
                    <div class="cal-result">
                        <div class="form-group">
                            <label>Calculated Scale:</label>
                            <span id="resultScaleRTD" class="result-value">--</span>
                        </div>
                        <div class="form-group">
                            <label>Calculated Offset:</label>
                            <span id="resultOffsetRTD" class="result-value">--</span>
                        </div>
                        <button class="btn btn-secondary" onclick="resetCalibrationRTD()" style="margin-top: 10px;">Reset to Default (1.0, 0.0)</button>
                    </div>
                </div>
                
                <div class="form-group checkbox-group">
                    <label>
                        <input type="checkbox" id="rtdShowOnDashboard">
                        Show on Dashboard
                    </label>
                </div>
            </div>
            
            <div class="modal-buttons">
                <button class="modal-cancel" onclick="closeRTDConfigModal()">Cancel</button>
                <button class="modal-confirm" onclick="saveRTDConfig()">Save</button>
            </div>
        </div>
    </div>
    
    <!-- GPIO Configuration Modal -->
    <div id="gpioConfigModal" class="modal-overlay">
        <div class="config-modal">
            <h3>Configure Digital Input <span id="gpioConfigIndex"></span></h3>
            <div class="config-form">
                <div class="form-group">
                    <label for="gpioConfigName">Name:</label>
                    <input type="text" id="gpioConfigName" maxlength="31" placeholder="Input name">
                </div>
                
                <div class="form-group">
                    <label for="gpioConfigPullMode">Pull Resistor:</label>
                    <select id="gpioConfigPullMode">
                        <option value="0">None (High-Z)</option>
                        <option value="1">Pull-Up</option>
                        <option value="2">Pull-Down</option>
                    </select>
                </div>
                
                <div class="form-group checkbox-group">
                    <label>
                        <input type="checkbox" id="gpioShowOnDashboard">
                        Show on Dashboard
                    </label>
                </div>
            </div>
            
            <div class="modal-buttons">
                <button class="modal-cancel" onclick="closeGPIOConfigModal()">Cancel</button>
                <button class="modal-confirm" onclick="saveGPIOConfig()">Save</button>
            </div>
        </div>
    </div>
    
    <!-- Digital Output Configuration Modal -->
    <div id="digitalOutputConfigModal" class="modal-overlay">
        <div class="config-modal">
            <h3>Configure Output <span id="outputConfigIndex"></span></h3>
            <div class="config-form">
                <div class="form-group">
                    <label for="outputConfigName">Name:</label>
                    <input type="text" id="outputConfigName" maxlength="31" placeholder="Output name">
                </div>
                
                <div class="form-group">
                    <label for="outputConfigMode">Mode:</label>
                    <select id="outputConfigMode">
                        <option value="0">On/Off</option>
                        <option value="1">PWM (0-100%)</option>
                    </select>
                </div>
                
                <div class="form-group checkbox-group">
                    <label>
                        <input type="checkbox" id="outputShowOnDashboard">
                        Show on Dashboard
                    </label>
                </div>
            </div>
            
            <div class="modal-buttons">
                <button class="modal-cancel" onclick="closeDigitalOutputConfigModal()">Cancel</button>
                <button class="modal-confirm" onclick="saveDigitalOutputConfig()">Save</button>
            </div>
        </div>
    </div>
    
    <!-- Stepper Motor Configuration Modal -->
    <div id="stepperConfigModal" class="modal-overlay">
        <div class="config-modal">
            <h3>Configure Stepper Motor</h3>
            <div class="config-form">
                <div class="form-group">
                    <label for="stepperConfigName">Name:</label>
                    <input type="text" id="stepperConfigName" maxlength="31" placeholder="Motor name">
                </div>
                
                <div class="form-group">
                    <label for="stepperStepsPerRev">Steps per Revolution:</label>
                    <input type="number" id="stepperStepsPerRev" min="100" max="1000" value="200">
                </div>
                
                <div class="form-group">
                    <label for="stepperMaxRPM">Max RPM:</label>
                    <input type="number" id="stepperMaxRPM" min="100" max="1000" value="500">
                </div>
                
                <div class="form-group">
                    <label for="stepperHoldCurrent">Hold Current (mA):</label>
                    <input type="number" id="stepperHoldCurrent" min="10" max="1000" value="500">
                </div>
                
                <div class="form-group">
                    <label for="stepperRunCurrent">Run Current (mA):</label>
                    <input type="number" id="stepperRunCurrent" min="10" max="1800" value="1000">
                </div>
                
                <div class="form-group">
                    <label for="stepperAcceleration">Acceleration (RPM/s):</label>
                    <input type="number" id="stepperAcceleration" min="10" max="1000" value="100">
                </div>
                
                <div class="form-group checkbox-group">
                    <label>
                        <input type="checkbox" id="stepperInvertDirection">
                        Invert Direction
                    </label>
                </div>
                
                <div class="form-group checkbox-group">
                    <label>
                        <input type="checkbox" id="stepperShowOnDashboard">
                        Show on Dashboard
                    </label>
                </div>
            </div>
            
            <div class="modal-buttons">
                <button class="modal-cancel" onclick="closeStepperConfigModal()">Cancel</button>
                <button class="modal-confirm" onclick="saveStepperConfig()">Save</button>
            </div>
        </div>
    </div>
    
    <!-- DC Motor Configuration Modal -->
    <div id="dcMotorConfigModal" class="modal-overlay">
        <div class="config-modal">
            <h3>Configure DC Motor <span id="dcMotorConfigIndex"></span></h3>
            <div class="config-form">
                <div class="form-group">
                    <label for="dcMotorConfigName">Name:</label>
                    <input type="text" id="dcMotorConfigName" maxlength="31" placeholder="Motor name">
                </div>
                
                <div class="form-group checkbox-group">
                    <label>
                        <input type="checkbox" id="dcMotorInvertDirection">
                        Invert Direction
                    </label>
                </div>
                
                <div class="form-group checkbox-group">
                    <label>
                        <input type="checkbox" id="dcMotorShowOnDashboard">
                        Show on Dashboard
                    </label>
                </div>
            </div>
            
            <div class="modal-buttons">
                <button class="modal-cancel" onclick="closeDCMotorConfigModal()">Cancel</button>
                <button class="modal-confirm" onclick="saveDCMotorConfig()">Save</button>
            </div>
        </div>
    </div>
    
    <script src="script.js"></script>
    <script src="outputs.js"></script>
</body>
</html>